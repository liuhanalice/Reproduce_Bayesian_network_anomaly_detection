##########################################################################################
File: Single_Experiment.py

options = EM_options(0.0008, 0.01, 3, 2.4, 1.5, defect_pos=np.array([[-0.9], [-1.4]]), bg_std_depth=0.1, step=-0.35, spline_flag=False)


##########################################################################################

0.0008 0.1
Number of points: 22726
points: [[-13.34231089 -20.0221187   42.31118647]
 [-13.2984371  -19.74855747  42.4650697 ]
 [-13.29788118 -19.48887393  42.77810435]
 ...
 [ 13.15620402  19.22122006  56.65592639]
 [ 13.16121074  19.44267441  56.81416046]
 [ 13.18823373  19.70269087  57.20983264]]
C_f,C_ns 0.25 0.020833333333333332
Tensor Estimation Running Time (per epoch) 41.515688499999996
tensor change per iteration:  0.4531458575743355
Tensor Estimation Running Time (per epoch) 59.33274170000001
tensor change per iteration:  0.23543351139099936
Tensor Estimation Running Time (per epoch) 78.9634515
tensor change per iteration:  0.1282018417349378
Tensor Estimation Running Time (per epoch) 49.66096000000002
tensor change per iteration:  0.07215329797497848
Tensor Estimation Running Time (per epoch) 48.02025789999999
tensor change per iteration:  0.04141296097045174
initial h and m are: [[-0.01166477 -0.08376733  0.99641707]] 49.76822254123123
current epoch is  0
Cf in current epoch: 0.25
Spline matrix 17.48813610000002
(22726, 1)
Posterior Probability Estimation Running Time 29.554347500000006
OPT_THR,OPT_SMOOTH 8.186363636363636 24.16946308724832
status: optimal
Running time of updating h, m and spline paras 15.297091499999965
estimated parameters in current epoch 1.1584529837240112 0.0204480197529131 0.09810272088409452 [5.06844418e-01 4.93155582e-01 1.36610681e-24] [[ 0.00557549]
 [-0.00385493]
 [ 0.99997703]] 49.35722908771873 [[-8.11031520e+00 -2.20863699e+00  3.58278620e-01  4.25393232e-02
   7.74291679e+00  8.06103812e+00 -5.28443490e-01 -7.64914738e+00
   2.55299510e+00 -4.75709444e-01  2.76282887e+00  6.04479981e+00
   1.17490014e+00  1.70109590e+00  8.39324021e-01  3.06632177e-01
   6.49868300e-01 -4.41156146e-02  9.65709944e-01  5.45010896e-01
   5.09589611e-01  8.14074140e-01  4.08238373e-01  5.05556965e-03
  -4.98997350e+00 -9.67450812e-01  1.09622247e+00  3.66784898e-01
   2.35229685e+00  6.71149199e+00 -8.09666962e+00 -6.29217923e+00
   1.04035036e+00  3.41461813e-01  7.37482788e+00  8.11931648e+00]]
current epoch is  1
Cf in current epoch: 0.25
Spline matrix 17.193857100000002
(22726, 1)
Posterior Probability Estimation Running Time 25.485783000000026
OPT_THR,OPT_SMOOTH 8.943434343434344 27.18939597315436
status: optimal
Running time of updating h, m and spline paras 14.58909490000002
estimated parameters in current epoch 0.0452670435687624 0.005534442149770154 0.09147958857105606 [0.8072949  0.18436466 0.00834045] [[ 0.02720608]
 [-0.06711007]
 [ 0.99737459]] 49.96494377684973 [[-8.79876146 -3.85884921 -0.16472662 -1.1054542   4.67990113  8.83265447
  -1.98946361 -5.27221099  1.34933233 -1.58047613  0.43275719  3.30855983
   1.50116597  1.7902872   0.36476055 -0.85223843 -1.38290541 -2.11806399
   2.04220454  1.01094034  0.4672973  -0.35216672 -1.26842391 -1.92656005
  -4.03212454 -0.21073306  0.98774773 -0.51474582  0.68903896  4.34497933
  -8.86732891 -5.37393684  0.96569469 -0.39115611  5.44174953  8.85905775]]
current epoch is  2
Cf in current epoch: 0.25
Spline matrix 17.020067600000004
(22726, 1)
Posterior Probability Estimation Running Time 23.06799410000002
OPT_THR,OPT_SMOOTH 9.094848484848486 25.176107382550335
status: optimal
Running time of updating h, m and spline paras 15.729138499999976
estimated parameters in current epoch 0.014724117944621716 0.004585015799563385 0.08865712408173168 [0.90454433 0.08225399 0.01320169] [[ 0.02359823]
 [-0.08069582]
 [ 0.99645939]] 49.95972760836633 [[-8.79094137 -4.8545564   0.16159961 -1.21833475  4.47453858  8.81819897
  -3.21989315 -3.4014174   0.9960799  -1.47280823  0.19144289  3.29307457
   2.09105749  1.71497094  0.45589429 -0.96810482 -1.69963659 -2.37701831
   2.1703666   1.34236143  0.56062382 -0.56664793 -1.58466146 -2.39789066
  -3.8589543  -0.22683004  0.98806283 -0.68840125  0.42663954  4.16121267
  -8.92944009 -5.04828938  0.95174493 -0.5750031   5.26028238  8.91549315]]
current epoch is  3
Cf in current epoch: 0.25
Spline matrix 17.005308300000024
(22726, 1)
Posterior Probability Estimation Running Time 23.230740000000026
OPT_THR,OPT_SMOOTH 9.246262626262626 25.176107382550335
status: optimal
Running time of updating h, m and spline paras 14.44811500000003
estimated parameters in current epoch 0.01118124452576563 0.004275162998354705 0.08738505162273327 [0.92701427 0.05677    0.01621574] [[ 0.00592637]
 [-0.08826209]
 [ 0.99607966]] 49.940592306647524 [[-8.93529374 -5.08548862  0.54194131 -0.98680707  4.56827945  8.91025614
  -3.66137018 -1.9125025   0.99006323 -1.21393575  0.21926298  3.46411972
   2.41105277  1.72594078  0.58242488 -0.89838082 -1.78104866 -2.48237417
   2.3038291   1.46927874  0.58274579 -0.76215497 -1.78552447 -2.62082824
  -3.93392571 -0.34998211  0.81914526 -0.9280103   0.11842815  3.69281244
  -9.00356021 -5.05491447  0.72606008 -0.83863421  4.69883992  9.01344091]]
current epoch is  4
Cf in current epoch: 0.25
Spline matrix 17.137938599999984
(22726, 1)
Posterior Probability Estimation Running Time 23.019190800000047
OPT_THR,OPT_SMOOTH 9.397676767676767 24.16946308724832
status: optimal
Running time of updating h, m and spline paras 14.493532899999991
estimated parameters in current epoch 0.010728987252656324 0.004157326696034908 0.08686710236823955 [0.93314821 0.04924077 0.01761102] [[ 2.17870437e-04]
 [-9.10448544e-02]
 [ 9.95846769e-01]] 49.71302870686144 [[-9.18931101 -4.90424458  0.82659057 -0.65530151  4.8230002   9.18089085
  -3.71594044 -0.86786459  1.13454187 -0.88636634  0.37656874  3.77550766
   2.65523577  1.87223621  0.82601345 -0.64624541 -1.60167062 -2.41154215
   2.60737337  1.78884513  0.81462224 -0.61965809 -1.64802679 -2.3808243
  -3.55052201 -0.19928319  1.00114912 -0.80974446  0.2980927   3.70179407
  -9.13433671 -4.65560234  0.81776355 -0.6580479   4.61800763  9.14647302]]
current epoch is  5
Cf in current epoch: 0.25
Spline matrix 17.462958200000003
(22726, 1)
Posterior Probability Estimation Running Time 23.046057099999985
OPT_THR,OPT_SMOOTH 9.549090909090909 22.156174496644297
status: optimal
Running time of updating h, m and spline paras 15.040533100000061
estimated parameters in current epoch 0.01056410665655734 0.004091552305155892 0.08657294590351476 [0.9330983  0.04843287 0.01846882] [[ 0.00570159]
 [-0.08733778]
 [ 0.99616244]] 49.63219982776129 [[-9.35887875 -4.85637559  0.75900855 -0.59877929  4.88705584  9.36534403
  -3.69918449 -0.65659755  1.10010058 -0.79648203  0.44493529  4.04430902
   2.63932345  1.85719571  0.86175933 -0.54274679 -1.44945486 -2.27460441
   2.64742751  1.85623954  0.91683245 -0.47176218 -1.48353757 -2.1586234
  -3.58906362 -0.14724332  1.14044038 -0.64002136  0.53318484  3.75806211
  -9.27897249 -4.52114166  0.96078158 -0.42385658  4.7217491   9.26600511]]
current epoch is  6
Cf in current epoch: 0.25
Spline matrix 17.84882140000002
(22726, 1)
Posterior Probability Estimation Running Time 22.414904399999955
OPT_THR,OPT_SMOOTH 9.397676767676767 23.16281879194631
status: optimal
Running time of updating h, m and spline paras 13.911484200000018
estimated parameters in current epoch 0.00992134081622385 0.004054545544246692 0.08640154976028497 [0.93207025 0.04893112 0.01899863] [[ 0.00147875]
 [-0.09108014]
 [ 0.99584247]] 49.634668752777465 [[-9.20265457 -4.82926126  0.85143954 -0.58608948  4.82374665  9.20145405
  -3.76573457 -0.33978839  1.09114283 -0.75778304  0.3801078   3.968839
   2.75023977  1.88423754  0.89186405 -0.56065968 -1.51718398 -2.33149432
   2.69282466  1.89110827  0.91705326 -0.54928129 -1.57266387 -2.2981351
  -3.55184249 -0.13480535  1.08735279 -0.71796548  0.37051611  3.59452789
  -9.11810403 -4.49943436  0.92097146 -0.54546097  4.55676584  9.12066429]]
current epoch is  7
Cf in current epoch: 0.25
Spline matrix 16.78632520000008
(22726, 1)
Posterior Probability Estimation Running Time 21.143081499999994
OPT_THR,OPT_SMOOTH 9.549090909090909 22.156174496644297
status: optimal
Running time of updating h, m and spline paras 12.72948770000005
estimated parameters in current epoch 0.010014139504334593 0.0040246690718557954 0.08626436482706658 [0.93081468 0.04976507 0.01942024] [[-4.06882472e-04]
 [-8.89415756e-02]
 [ 9.96036762e-01]] 49.68326700240815 [[-9.34084189 -4.95638348  0.81051838 -0.54147937  4.86110243  9.33909841
  -4.04636598 -0.33989458  1.03807106 -0.76539344  0.41647334  3.91549709
   2.6404802   1.78417918  0.84103944 -0.57068944 -1.53171316 -2.34423058
   2.62182141  1.83125111  0.84976078 -0.58354433 -1.57509821 -2.26600145
  -3.52875964 -0.23850749  1.02094558 -0.76854441  0.3956886   3.71693353
  -9.2530991  -4.57515117  0.81254216 -0.58717511  4.60367528  9.2557738 ]]
current epoch is  8
Cf in current epoch: 0.25
Spline matrix 15.573765499999922
(22726, 1)
Posterior Probability Estimation Running Time 20.385158600000068
OPT_THR,OPT_SMOOTH 9.549090909090909 22.156174496644297
status: optimal
Running time of updating h, m and spline paras 19.472609899999952
estimated parameters in current epoch 0.009882380555265264 0.0040218943066475665 0.08625325858077873 [0.93102591 0.04949924 0.01947485] [[ 0.00594227]
 [-0.08847538]
 [ 0.99606064]] 49.642677045290284 [[-9.33511407 -4.90802375  0.74229992 -0.60776856  4.79957593  9.34457852
  -3.88066873 -0.42700646  1.02899657 -0.79467442  0.38318456  3.96365301
   2.65413677  1.81763655  0.84929777 -0.55910003 -1.49078539 -2.30819948
   2.66455742  1.87675628  0.91916188 -0.50167974 -1.51108183 -2.19124132
  -3.54102693 -0.14097966  1.13050101 -0.65682483  0.49869687  3.70172905
  -9.25769408 -4.48006711  0.95685283 -0.44354002  4.6597615   9.2363343 ]]
current epoch is  9
Cf in current epoch: 0.25
Spline matrix 16.57197270000006
(22726, 1)
Posterior Probability Estimation Running Time 29.54387399999996
OPT_THR,OPT_SMOOTH 9.397676767676767 22.156174496644297
status: optimal
Running time of updating h, m and spline paras 30.6464997999999
estimated parameters in current epoch 0.010039122920359453 0.004023269919595637 0.08625903603979708 [0.93039698 0.05015614 0.01944688] [[-0.00169868]
 [-0.08940741]
 [ 0.99599369]] 49.698856289957334 [[-9.21322066 -5.07624232  0.85587034 -0.57366033  4.90609422  9.20794803
  -4.15420022 -0.2662754   1.00580196 -0.74576124  0.38287568  3.94750949
   2.67047389  1.76809272  0.83617761 -0.58668405 -1.5477023  -2.35439962
   2.61358789  1.80747034  0.83769912 -0.61831673 -1.59476294 -2.33338889
  -3.62189804 -0.24316017  0.96847933 -0.78115926  0.31892911  3.73738101
  -9.1456349  -4.67368894  0.80843288 -0.65766351  4.63691117  9.15521777]]
current epoch is  10
Cf in current epoch: 0.25
Spline matrix 31.29149170000005
(22726, 1)
Posterior Probability Estimation Running Time 38.437075200000095
OPT_THR,OPT_SMOOTH 9.549090909090909 21.149530201342284
status: optimal
Running time of updating h, m and spline paras 22.189590400000043
estimated parameters in current epoch 0.00995973387888741 0.004021334379969575 0.08625075330781552 [0.93078674 0.04972875 0.01948451] [[ 0.00508137]
 [-0.08604217]
 [ 0.99627854]] 49.65795114904846 [[-9.33511936 -4.96682657  0.74514215 -0.58202189  4.81691541  9.34402967
  -3.9824627  -0.45475283  1.00814458 -0.76904313  0.42178557  3.96245741
   2.58342016  1.76291555  0.83067787 -0.53984253 -1.45173432 -2.25900311
   2.60781772  1.83113168  0.89111795 -0.49220441 -1.46929057 -2.1301661
  -3.51661056 -0.1809912   1.0972435  -0.64849128  0.51667983  3.73980704
  -9.25018037 -4.47520904  0.91738405 -0.4488628   4.65157123  9.22851752]]
current epoch is  11
Cf in current epoch: 0.25
Spline matrix 29.842304300000023
(22726, 1)
Posterior Probability Estimation Running Time 41.68064620000007
OPT_THR,OPT_SMOOTH 9.549090909090909 21.149530201342284
status: optimal
Running time of updating h, m and spline paras 26.00301619999982
estimated parameters in current epoch 0.009658315845536329 0.004021753779705002 0.08625242158807414 [0.93105393 0.0494726  0.01947347] [[ 0.00213895]
 [-0.0863829 ]
 [ 0.99625971]] 49.65557618980509 [[-9.35075846 -4.9265963   0.79492541 -0.55081662  4.8836439   9.35136756
  -3.92077953 -0.37534705  1.03553616 -0.72607378  0.45266382  4.05846526
   2.63906214  1.78909315  0.84961802 -0.52612345 -1.43834228 -2.2256418
   2.587989    1.81516549  0.88559374 -0.51156252 -1.48841492 -2.18510985
  -3.64256938 -0.21700636  1.05980417 -0.67794772  0.46573914  3.68898913
  -9.26609619 -4.5645694   0.8898119  -0.4939422   4.63343096  9.2647218 ]]
current epoch is  12
Cf in current epoch: 0.25
Spline matrix 31.036399200000005
(22726, 1)
Posterior Probability Estimation Running Time 40.99818460000006
OPT_THR,OPT_SMOOTH 9.549090909090909 22.156174496644297
status: optimal
Running time of updating h, m and spline paras 21.390720399999964
estimated parameters in current epoch 0.009658794327122409 0.004007843358454053 0.08618898075867468 [0.93083452 0.04948272 0.01968277] [[ 0.00112651]
 [-0.08898833]
 [ 0.99603203]] 49.64523391858006 [[-9.32704746 -4.86085149  0.81500885 -0.53098001  4.80275105  9.32713257
  -3.90244845 -0.31708996  1.06566227 -0.74169773  0.41842841  3.91061781
   2.67469798  1.82719882  0.87146324 -0.53752788 -1.48822313 -2.28947241
   2.64940474  1.86814123  0.89634336 -0.5336445  -1.53383743 -2.21931154
  -3.48409695 -0.18240329  1.07682143 -0.71444514  0.42421476  3.6327041
  -9.22773586 -4.48066773  0.87291212 -0.51827046  4.54888992  9.22473161]]
current epoch is  13
Cf in current epoch: 0.25
Spline matrix 30.53374440000016
(22726, 1)
Posterior Probability Estimation Running Time 54.10052360000009
OPT_THR,OPT_SMOOTH 9.549090909090909 21.149530201342284
status: optimal
Running time of updating h, m and spline paras 31.826467100000173
estimated parameters in current epoch 0.009545834082301705 0.004018911029403003 0.08623937155563818 [0.93092908 0.04955434 0.01951658] [[ 0.00248675]
 [-0.08642835]
 [ 0.99625497]] 49.65362988323606 [[-9.34105385 -4.91236994  0.78311184 -0.53822569  4.84115773  9.34415051
  -3.96302653 -0.37851946  1.03356163 -0.73349624  0.44664536  3.98707876
   2.615137    1.78000413  0.84897553 -0.52488661 -1.44384925 -2.24307225
   2.60320631  1.83061672  0.8869027  -0.50632466 -1.48380629 -2.15442233
  -3.53381914 -0.20496486  1.07362406 -0.67725075  0.48368478  3.69506349
  -9.24570094 -4.49253479  0.88126382 -0.47979219  4.59792539  9.23710841]]
current epoch is  14
Cf in current epoch: 0.25
Spline matrix 40.3569550000002
(22726, 1)
Posterior Probability Estimation Running Time 36.28823310000007
OPT_THR,OPT_SMOOTH 9.397676767676767 24.16946308724832
status: optimal
Running time of updating h, m and spline paras 23.837763300000006
estimated parameters in current epoch 0.00989578534523981 0.004022201101398711 0.08625427102854806 [0.93040802 0.05012799 0.01946399] [[-6.07254573e-04]
 [-9.42102436e-02]
 [ 9.95552139e-01]] 49.66213889610513 [[-9.1856367  -4.92148561  0.86882754 -0.59461248  4.79055526  9.18307746
  -3.98583267 -0.20258879  1.05556887 -0.78838455  0.30202135  3.80426972
   2.76685592  1.86365918  0.88076866 -0.6124526  -1.62194937 -2.46200485
   2.73998398  1.91652917  0.89051591 -0.63085555 -1.66311012 -2.39554369
  -3.43069847 -0.135093    1.04150821 -0.79853569  0.27770831  3.61495769
  -9.10574976 -4.51635736  0.85980448 -0.64640179  4.53639963  9.10918175]]
current epoch is  15
Cf in current epoch: 0.25
Spline matrix 44.259805500000084
(22726, 1)
Posterior Probability Estimation Running Time 70.47463670000002
OPT_THR,OPT_SMOOTH 9.397676767676767 23.16281879194631
status: optimal
Running time of updating h, m and spline paras 38.2154258999999
estimated parameters in current epoch 0.00983095328141232 0.004021194605689871 0.08625007084504455 [0.93086156 0.04965278 0.01948565] [[ 0.00399154]
  -3.43069847 -0.135093    1.04150821 -0.79853569  0.27770831  3.61495769
  -9.10574976 -4.51635736  0.85980448 -0.64640179  4.53639963  9.10918175]]
current epoch is  15
Cf in current epoch: 0.25
Spline matrix 44.259805500000084
(22726, 1)
Posterior Probability Estimation Running Time 70.47463670000002
OPT_THR,OPT_SMOOTH 9.397676767676767 23.16281879194631
status: optimal
Running time of updating h, m and spline paras 38.2154258999999
estimated parameters in current epoch 0.00983095328141232 0.004021194605689871 0.08625007084504455 [0.93086156 0.04965278 0.01948565] [[ 0.00399154]
current epoch is  15
Cf in current epoch: 0.25
Spline matrix 44.259805500000084
(22726, 1)
Posterior Probability Estimation Running Time 70.47463670000002
OPT_THR,OPT_SMOOTH 9.397676767676767 23.16281879194631
status: optimal
Running time of updating h, m and spline paras 38.2154258999999
estimated parameters in current epoch 0.00983095328141232 0.004021194605689871 0.08625007084504455 [0.93086156 0.04965278 0.01948565] [[ 0.00399154]
Spline matrix 44.259805500000084
(22726, 1)
Posterior Probability Estimation Running Time 70.47463670000002
OPT_THR,OPT_SMOOTH 9.397676767676767 23.16281879194631
status: optimal
Running time of updating h, m and spline paras 38.2154258999999
estimated parameters in current epoch 0.00983095328141232 0.004021194605689871 0.08625007084504455 [0.93086156 0.04965278 0.01948565] [[ 0.00399154]
Posterior Probability Estimation Running Time 70.47463670000002
OPT_THR,OPT_SMOOTH 9.397676767676767 23.16281879194631
status: optimal
Running time of updating h, m and spline paras 38.2154258999999
estimated parameters in current epoch 0.00983095328141232 0.004021194605689871 0.08625007084504455 [0.93086156 0.04965278 0.01948565] [[ 0.00399154]
 [-0.0910341 ]
status: optimal
Running time of updating h, m and spline paras 38.2154258999999
estimated parameters in current epoch 0.00983095328141232 0.004021194605689871 0.08625007084504455 [0.93086156 0.04965278 0.01948565] [[ 0.00399154]
 [-0.0910341 ]
 [-0.0910341 ]
 [ 0.99583978]] 49.642299550178386 [[-9.18745306 -4.86988667  0.79419481 -0.60923885  4.75056871  9.19360807
 [ 0.99583978]] 49.642299550178386 [[-9.18745306 -4.86988667  0.79419481 -0.60923885  4.75056871  9.19360807
  -3.88838205 -0.35323295  1.05049473 -0.80003556  0.34561124  3.8808325
  -3.88838205 -0.35323295  1.05049473 -0.80003556  0.34561124  3.8808325
   2.70304372  1.84897666  0.86910802 -0.57925553 -1.54273482 -2.37667559
   2.71307095  1.91088958  0.91936715 -0.54338985 -1.56991947 -2.26118739
  -3.43099643 -0.11360078  1.1177825  -0.70548171  0.41602129  3.63319259
  -9.09969529 -4.40425904  0.93393694 -0.50801809  4.55307264  9.0843065 ]]

confs_mat: [[2.1267e+04 7.0000e+00 1.8600e+02]
 [5.6000e+01 9.5200e+02 6.4000e+01]
 [0.0000e+00 0.0000e+00 1.9400e+02]]
FPR,FNR 0.000323265909300822 0.11194029850746269