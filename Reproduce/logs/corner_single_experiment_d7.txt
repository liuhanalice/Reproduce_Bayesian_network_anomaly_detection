##########################################################################################
File: Single_Experiment.py

options = EM_options(0.0008, 0.01, 7, 2.4, 1.5, defect_pos=np.array([[-0.9], [-1.4]]), bg_std_depth=0.1, step=-0.35, spline_flag=False)


##########################################################################################

0.0008 0.1
Number of points: 22726
points: [[-13.34231089 -20.0221187   42.31118647]
 [-13.2984371  -19.74855747  42.4650697 ]
 [-13.29788118 -19.48887393  42.77810435]
 ...
 [ 13.15620402  19.22122006  56.65592639]
 [ 13.16121074  19.44267441  56.81416046]
 [ 13.18823373  19.70269087  57.20983264]]
C_f,C_ns 0.25 0.020833333333333332
Tensor Estimation Running Time (per epoch) 30.675501700000012
tensor change per iteration:  0.453342854464422
Tensor Estimation Running Time (per epoch) 27.64289930000001
tensor change per iteration:  0.23581390276192635
Tensor Estimation Running Time (per epoch) 27.692676800000015
tensor change per iteration:  0.12852139059901635
Tensor Estimation Running Time (per epoch) 27.977650399999987
tensor change per iteration:  0.07238300054936804
Tensor Estimation Running Time (per epoch) 27.512321799999995
tensor change per iteration:  0.041570324335780486
initial h and m are: [[-0.0246317  -0.09263129  0.99539576]] 49.64566608915331
current epoch is  0
Cf in current epoch: 0.25
Spline matrix 12.659109199999989
(22726, 1)
Posterior Probability Estimation Running Time 17.3835325
OPT_THR,OPT_SMOOTH 8.186363636363636 25.176107382550335
status: optimal
Running time of updating h, m and spline paras 8.674276299999974
estimated parameters in current epoch 1.7493609986350172 0.02258378816172186 0.1019014771596057 [4.68916652e-01 5.31083348e-01 1.28560556e-24] [[-0.01175307]
 [-0.03738022]
 [ 0.999232  ]] 48.926591463119465 [[-8.13639245e+00 -1.51894729e+00  1.34834325e+00  4.87295450e-01
   7.88942426e+00  8.12059178e+00  5.09940876e-02 -5.73142152e+00
   3.14982477e+00 -7.73129867e-03  2.68954796e+00  6.22280221e+00
   2.51549822e+00  2.43166761e+00  1.61023703e+00  5.63825327e-01
   5.09000457e-01 -4.19580547e-01  2.15815072e+00  1.60067672e+00
   1.11623603e+00  8.19272186e-01  1.83757954e-01 -4.02089700e-01
  -4.19263965e+00 -2.40359556e-01  1.50528593e+00  3.74612959e-01
   1.93755078e+00  6.28841278e+00 -8.09895700e+00 -5.39704568e+00
   1.35659162e+00  3.09422825e-01  6.95428969e+00  8.14196412e+00]]
current epoch is  1
Cf in current epoch: 0.25
Spline matrix 12.443509300000017
(22726, 1)
Posterior Probability Estimation Running Time 17.449230900000032
OPT_THR,OPT_SMOOTH 9.094848484848486 27.18939597315436
status: optimal
Running time of updating h, m and spline paras 8.246434099999988
estimated parameters in current epoch 0.05774265558298713 0.006977307935174525 0.09540892899426529 [0.78201514 0.2099324  0.00805246] [[ 0.02252251]
 [-0.08550112]
 [ 0.99608348]] 49.6171994524118 [[-8.96369544 -3.9839863   0.51643908 -0.96445636  4.78437161  8.97300421
  -2.37600388 -3.1600828   1.44450958 -1.18808172  0.35471406  3.48725067
   2.40590946  2.10137547  0.82250512 -0.67092742 -1.41376943 -2.321859
   2.66501687  1.74104602  0.91422423 -0.27865996 -1.32331723 -2.00088233
  -3.23148474  0.25153214  1.32578964 -0.39486254  0.6537629   4.06116684
  -9.00467344 -4.51536574  1.28920981 -0.26512     5.11770036  9.00691629]]
current epoch is  2
Cf in current epoch: 0.25
Spline matrix 12.067954199999974
(22726, 1)
Posterior Probability Estimation Running Time 16.172176999999976
OPT_THR,OPT_SMOOTH 9.246262626262626 23.16281879194631
status: optimal
Running time of updating h, m and spline paras 8.419174599999963
estimated parameters in current epoch 0.014083426195741069 0.00586249134893854 0.09216926054532969 [0.90308465 0.08255927 0.01435608] [[ 0.00793642]
 [-0.08624128]
 [ 0.99624267]] 49.79807405670456 [[-9.05569275 -5.14471312  0.57785878 -0.77244975  4.73788934  9.05005049
  -3.91283617 -1.42782101  1.05250117 -1.06594256  0.37431159  3.68676255
   2.50535112  1.75361586  0.67401557 -0.71017802 -1.61794926 -2.34245135
   2.43117823  1.64245805  0.73993279 -0.59193057 -1.59254284 -2.37980503
  -3.70512285 -0.27759796  1.00931052 -0.77076154  0.392291    3.93994782
  -9.03287402 -4.81016896  0.83224128 -0.59489838  4.9430913   9.03393044]]
current epoch is  3
Cf in current epoch: 0.25
Spline matrix 11.84473650000001
(22726, 1)
Posterior Probability Estimation Running Time 16.056240000000003
OPT_THR,OPT_SMOOTH 9.397676767676767 24.16946308724832
status: optimal
Running time of updating h, m and spline paras 8.409271199999978
estimated parameters in current epoch 0.010248055489385406 0.005261413428932917 0.08998174623150992 [0.92926708 0.05056162 0.0201713 ] [[-0.00168182]
 [-0.09290898]
 [ 0.99567319]] 49.737939692025144 [[-9.16232332 -5.14439941  0.85655097 -0.6617482   4.7912534   9.1527026
  -4.09846079 -0.38721201  1.01862456 -0.85688228  0.3019934   3.75536605
   2.69799573  1.80290814  0.80331278 -0.66446076 -1.67545663 -2.46791956
   2.62614311  1.80239542  0.80512446 -0.69679969 -1.70953444 -2.473788
  -3.59410555 -0.2289301   0.94534677 -0.86573044  0.21000442  3.63845176
  -9.11213214 -4.70192808  0.77500871 -0.73348876  4.56260373  9.12469161]]
current epoch is  4
Cf in current epoch: 0.25
Spline matrix 12.323151300000006
(22726, 1)
Posterior Probability Estimation Running Time 16.100422100000003
OPT_THR,OPT_SMOOTH 9.549090909090909 21.149530201342284
status: optimal
Running time of updating h, m and spline paras 8.277848099999972
estimated parameters in current epoch 0.010397309618208065 0.004700646148790828 0.08778715818742883 [0.93271124 0.04074984 0.02653892] [[ 0.00701992]
 [-0.08576074]
 [ 0.99629103]] 49.68552520071388 [[-9.32990385 -5.08790992  0.70566889 -0.64113147  4.77381869  9.3424756
  -4.07424557 -0.46445917  0.95745416 -0.82211651  0.39293994  3.94350214
   2.54631127  1.74490057  0.78232185 -0.56677864 -1.49301439 -2.27917967
   2.58541368  1.7955098   0.87380698 -0.51004086 -1.48853222 -2.15070452
  -3.59685446 -0.19336952  1.09448553 -0.65691222  0.53028205  3.76355386
  -9.27065188 -4.52894938  0.91499409 -0.43674885  4.68956433  9.24564376]]
current epoch is  5
Cf in current epoch: 0.25
Spline matrix 12.088641600000017
(22726, 1)
Posterior Probability Estimation Running Time 16.05904289999995
OPT_THR,OPT_SMOOTH 9.549090909090909 21.149530201342284
status: optimal
Running time of updating h, m and spline paras 8.327334500000006
estimated parameters in current epoch 0.009833632251042036 0.004322909034610102 0.08624103079055617 [0.9329003  0.03584831 0.03125139] [[-8.74850697e-04]
 [-8.69658953e-02]
 [ 9.96210905e-01]] 49.69190176807159 [[-9.3375167  -5.07377751  0.82148768 -0.53128442  4.84795803  9.33270788
  -4.13141839 -0.23740464  1.00039085 -0.72583792  0.44274503  3.95502324
   2.62107824  1.75534984  0.82219979 -0.54133654 -1.49071968 -2.24814091
   2.55990781  1.78132635  0.83969407 -0.57180846 -1.53955955 -2.2429012
  -3.6349388  -0.27675732  0.99538589 -0.75111809  0.38886072  3.65960303
  -9.25827578 -4.63000299  0.7961704  -0.57889213  4.57273985  9.26622071]]
current epoch is  6
Cf in current epoch: 0.25
Spline matrix 12.37094419999994
(22726, 1)
Posterior Probability Estimation Running Time 16.051755699999944
OPT_THR,OPT_SMOOTH 9.397676767676767 23.16281879194631
status: optimal
Running time of updating h, m and spline paras 8.464833200000044
estimated parameters in current epoch 0.009842039647266 0.004052237195838061 0.08509647518195947 [0.93262248 0.03253986 0.03483766] [[ 0.00805056]
 [-0.09162316]
 [ 0.99576121]] 49.663824700872226 [[-9.1912068  -5.08457776  0.73667193 -0.71951411  4.73518032  9.20514733
  -4.03860202 -0.25783065  0.94229553 -0.84875763  0.24761541  3.90391968
   2.69536693  1.81847115  0.82078013 -0.62286344 -1.5928783  -2.42425726
   2.72800103  1.89517104  0.9286833  -0.55845902 -1.58998588 -2.29814637
  -3.58420812 -0.07892326  1.12380611 -0.67964564  0.41909903  3.63594267
  -9.1483013  -4.52041555  1.00208058 -0.48760188  4.64373857  9.12320669]]
current epoch is  7
Cf in current epoch: 0.25
Spline matrix 11.92105929999991
(22726, 1)
Posterior Probability Estimation Running Time 15.919186000000082
OPT_THR,OPT_SMOOTH 9.549090909090909 22.156174496644297
status: optimal
Running time of updating h, m and spline paras 8.412349300000074
estimated parameters in current epoch 0.009862070122665335 0.003819118970088232 0.08407907389132693 [0.93197648 0.02963813 0.0383854 ] [[-0.0023554 ]
 [-0.08911724]
 [ 0.99601836]] 49.68712638726967 [[-9.32966132 -5.01223205  0.84110784 -0.51407753  4.83453715  9.32163004
  -4.07962214 -0.19732246  1.03746066 -0.74176349  0.44154942  3.92514203
   2.6711569   1.79649622  0.84035633 -0.55613043 -1.53210997 -2.29726858
   2.59608112  1.8158316   0.84312684 -0.59957112 -1.59226047 -2.31062174
  -3.59629975 -0.28120492  0.99868115 -0.80045108  0.35329687  3.61940437
  -9.23790543 -4.60726836  0.78026002 -0.61379012  4.52823068  9.25180205]]
current epoch is  8
Cf in current epoch: 0.25
Spline matrix 12.16428510000003
(22726, 1)
Posterior Probability Estimation Running Time 15.923102100000051
OPT_THR,OPT_SMOOTH 9.549090909090909 21.149530201342284
status: optimal
Running time of updating h, m and spline paras 8.173706300000049
estimated parameters in current epoch 0.009592142120544222 0.0036661151234132945 0.08338338473301654 [0.93189444 0.02740292 0.04070263] [[ 0.00498166]
 [-0.08660344]
 [ 0.99623041]] 49.691656486778044 [[-9.32630847 -5.10204052  0.73314237 -0.61416818  4.76659294  9.33700334
  -4.15583063 -0.33258789  0.93851872 -0.79612189  0.37486107  3.89490903
   2.551689    1.72129916  0.79111483 -0.57150951 -1.50690319 -2.30954639
   2.59783227  1.80689605  0.86500147 -0.5385929  -1.51286932 -2.1690471
  -3.52066432 -0.20157811  1.0593731  -0.68800915  0.48392925  3.71034674
  -9.25674405 -4.50053224  0.88502244 -0.48799788  4.60968009  9.23338891]]
current epoch is  9
Cf in current epoch: 0.25
Spline matrix 11.950466800000072
(22726, 1)
Posterior Probability Estimation Running Time 16.003465199999937
OPT_THR,OPT_SMOOTH 9.549090909090909 21.149530201342284
status: optimal
Running time of updating h, m and spline paras 8.182701800000018
estimated parameters in current epoch 0.009501596365804098 0.003567177238444277 0.08293780971483442 [0.93153732 0.02626499 0.04219769] [[ 0.00141048]
 [-0.08686716]
 [ 0.99621891]] 49.676531624261536 [[-9.3299631  -5.02787292  0.798213   -0.55272358  4.80812495  9.33055738
  -4.0724851  -0.23581332  0.98901516 -0.73526014  0.42782012  3.95995597
   2.61636231  1.75874862  0.82624927 -0.53891746 -1.47807989 -2.24842722
   2.58091631  1.80756321  0.86634532 -0.54439572 -1.51620293 -2.20873661
  -3.59152829 -0.23840339  1.03295878 -0.71088575  0.4307091   3.64538419
  -9.24840167 -4.53496172  0.85079718 -0.52988395  4.56567237  9.24521556]]
current epoch is  10
Cf in current epoch: 0.25
Spline matrix 11.96640350000007
(22726, 1)
Posterior Probability Estimation Running Time 16.236654899999962
OPT_THR,OPT_SMOOTH 9.549090909090909 22.156174496644297
status: optimal
Running time of updating h, m and spline paras 8.309332500000096
estimated parameters in current epoch 0.009708163887850998 0.0035247179442768808 0.08272637241131149 [0.93102993 0.02573626 0.04323382] [[ 4.89521867e-04]
 [-8.96340616e-02]
 [ 9.95974646e-01]] 49.69646588913137 [[-9.32690266 -5.08454649  0.8045309  -0.57799202  4.80550843  9.32820112
  -4.17434323 -0.19487518  0.97341654 -0.77704982  0.36297813  3.85769957
   2.63136451  1.75840582  0.81907521 -0.5877829  -1.56769411 -2.37094564
   2.63071568  1.83284704  0.84900941 -0.60532888 -1.59260611 -2.28991592
  -3.51928312 -0.22525559  1.00994232 -0.77062223  0.36975285  3.68081063
  -9.25440819 -4.56494047  0.8199845  -0.6011517   4.58205411  9.25031171]]
current epoch is  11
Cf in current epoch: 0.25
Spline matrix 12.124533700000029
(22726, 1)
Posterior Probability Estimation Running Time 15.926466299999902
OPT_THR,OPT_SMOOTH 9.549090909090909 20.14288590604027
status: optimal
Running time of updating h, m and spline paras 8.370268900000042
estimated parameters in current epoch 0.009556295363445278 0.0034743129214300835 0.082492719040391 [0.93111418 0.02468547 0.04420035] [[ 0.00386756]
 [-0.08429878]
 [ 0.99643302]] 49.70754722053932 [[-9.33559477 -5.17128453  0.73675878 -0.59514039  4.82063725  9.34367915
  -4.25349994 -0.31823536  0.91191682 -0.76236997  0.41763621  3.96264268
   2.51644764  1.67236045  0.77336682 -0.5525862  -1.47008628 -2.24679149
   2.5309899   1.75710329  0.83899226 -0.53608847 -1.47644962 -2.1471451
  -3.62581419 -0.26216056  1.01565936 -0.68009404  0.4926687   3.77062103
  -9.27665645 -4.5808309   0.85292445 -0.5048464   4.65863783  9.26081539]]
current epoch is  12
Cf in current epoch: 0.25
Spline matrix 12.104053799999974
(22726, 1)
Posterior Probability Estimation Running Time 16.362077
OPT_THR,OPT_SMOOTH 9.549090909090909 22.156174496644297
status: optimal
Running time of updating h, m and spline paras 8.332331299999964
estimated parameters in current epoch 0.009497471566972289 0.003455353169423863 0.08239530335915395 [0.93106122 0.02482365 0.04411512] [[ 0.00418531]
 [-0.08918993]
 [ 0.99600584]] 49.667326898022125 [[-9.30790376 -5.01344253  0.7679499  -0.61098057  4.72767489  9.31474534
  -4.02332998 -0.22390155  0.97771368 -0.78881816  0.35772696  3.88767669
   2.66151954  1.7904389   0.82646928 -0.56891753 -1.5324541  -2.30931996
   2.63438346  1.85736247  0.89628309 -0.5489976  -1.5479394  -2.25155715
  -3.54165687 -0.17217278  1.08073008 -0.70125605  0.42171849  3.60173536
  -9.23780691 -4.47775628  0.9082938  -0.5043252   4.5628739   9.22235586]]
current epoch is  13
Cf in current epoch: 0.25
Spline matrix 12.174621800000068
(22726, 1)
Posterior Probability Estimation Running Time 16.371688199999994
OPT_THR,OPT_SMOOTH 9.549090909090909 21.149530201342284
status: optimal
Running time of updating h, m and spline paras 8.419016700000043
estimated parameters in current epoch 0.009458028747914727 0.0034471428837815664 0.08235131633015699 [0.93092319 0.02466807 0.04440874] [[ 0.00516372]
 [-0.08668937]
 [ 0.99622201]] 49.68374179246114 [[-9.33516347 -5.10597458  0.73447663 -0.6246026   4.81760807  9.34321083
  -4.12237135 -0.27152554  0.93568768 -0.78173192  0.39058573  4.02209342
   2.61001853  1.73841824  0.79833234 -0.56450298 -1.49764168 -2.27207108
   2.58179538  1.81017422  0.87888188 -0.53507852 -1.51111679 -2.21432329
  -3.66868125 -0.2164204   1.06326939 -0.67623926  0.474287    3.69254436
  -9.27366883 -4.55789206  0.90930932 -0.48435928  4.65812123  9.25770019]]
current epoch is  14
Cf in current epoch: 0.25
Spline matrix 11.780711199999928
(22726, 1)
Posterior Probability Estimation Running Time 16.00567410000008
OPT_THR,OPT_SMOOTH 9.397676767676767 23.16281879194631
status: optimal
Running time of updating h, m and spline paras 8.182375200000024
estimated parameters in current epoch 0.009410791307065106 0.0034421202831387944 0.08232453647062354 [0.93082936 0.02489527 0.04427537] [[ 0.00470451]
 [-0.09177945]
 [ 0.99576825]] 49.66591414325462 [[-9.17970064 -5.0523176   0.7917564  -0.67126883  4.73590771  9.18637092
  -4.02803506 -0.15960291  0.96468415 -0.81045289  0.29009815  3.90901766
   2.72805194  1.82105475  0.83628038 -0.60491795 -1.58721949 -2.38647456
   2.69299155  1.89002514  0.91339543 -0.5824708  -1.60207927 -2.34030294
  -3.57643197 -0.12497314  1.08350491 -0.71519911  0.35934426  3.57635555
  -9.12169124 -4.49324185  0.94547798 -0.54414316  4.57000385  9.10828213]]
current epoch is  15
Cf in current epoch: 0.25
Spline matrix 11.996526499999959
(22726, 1)
Posterior Probability Estimation Running Time 16.043111599999975
OPT_THR,OPT_SMOOTH 9.397676767676767 22.156174496644297
status: optimal
Running time of updating h, m and spline paras 8.339594799999986
estimated parameters in current epoch 0.009494800852101196 0.0034345280790349987 0.08229109408626568 [0.93085656 0.02423837 0.04490507] [[ 0.00253646]
 [-0.0893723 ]
 [ 0.99599506]] 49.67770792370879 [[-9.18665079 -5.04277883  0.80434208 -0.61269487  4.76573998  9.18977059
  -4.09455635 -0.18613671  0.97147271 -0.77356118  0.35711451  3.92381001
   2.6691997   1.78096452  0.82804472 -0.57632294 -1.54257873 -2.3302628
   2.63397029  1.84610851  0.88247339 -0.5753763  -1.56592676 -2.28570223
  -3.56531381 -0.18781264  1.04601132 -0.72390336  0.38263842  3.63002595
  -9.11670052 -4.49876771  0.88358222 -0.55671003  4.55512632  9.10951262]]
[Open3D WARNING] GLFW Error: WGL: Failed to make context current: The requested transformation operation is not supported. 
[Open3D WARNING] GLFW Error: WGL: Failed to make context current: The handle is invalid. 
[Open3D WARNING] GLFW Error: WGL: Failed to make context current: The requested transformation operation is not supported. 
[Open3D WARNING] [ViewControl] SetViewPoint() failed because window height and width are not set.
confs_mat: [[2.1225e+04 0.0000e+00 2.3500e+02]
 [1.2000e+01 4.6700e+02 5.9300e+02]
 [0.0000e+00 0.0000e+00 1.9400e+02]]
FPR,FNR 0.0 0.5643656716417911