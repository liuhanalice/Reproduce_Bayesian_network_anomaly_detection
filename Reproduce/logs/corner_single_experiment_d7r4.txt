##########################################################################################
File: Single_Experiment.py

options = EM_options(0.0008, 0.01, 7, 4, 1.5, defect_pos=np.array([[-0.7], [-1.3]]), bg_std_depth=0.1, step=-0.35, spline_flag=False)


##########################################################################################

0.0008 0.1
Number of points: 23139
points: [[-13.34231089 -20.0221187   42.31118647]
 [-13.2984371  -19.74855747  42.4650697 ]
 [-13.29788118 -19.48887393  42.77810435]
 ...
 [ 13.1546306   19.21406135  56.77902516]
 [ 13.18584126  19.45257118  56.71960616]
 [ 13.14557475  19.75241295  57.07068757]]
C_f,C_ns 0.25 0.020833333333333332
Tensor Estimation Running Time (per epoch) 33.1820758
tensor change per iteration:  0.45681110818165094
Tensor Estimation Running Time (per epoch) 36.948888600000004
tensor change per iteration:  0.2391168074932071
Tensor Estimation Running Time (per epoch) 35.35465549999999
tensor change per iteration:  0.1309434982802354
Tensor Estimation Running Time (per epoch) 35.43797280000001
tensor change per iteration:  0.07401576342728806
Tensor Estimation Running Time (per epoch) 36.48828360000002
tensor change per iteration:  0.04263816439950813
initial h and m are: [[-0.04978231 -0.11598821  0.99200225]] 49.237502106829204
current epoch is  0
Cf in current epoch: 0.25
Spline matrix 13.76610199999999
(23139, 1)
Posterior Probability Estimation Running Time 18.253788799999995
OPT_THR,OPT_SMOOTH 8.792020202020202 40.275771812080535
status: optimal
Running time of updating h, m and spline paras 8.668410699999981
estimated parameters in current epoch 2.286063333672808 0.022578814160395432 0.10460401377206748 [4.23928128e-01 5.76071872e-01 1.06695649e-23] [[-0.07570357]       
 [-0.0427608 ]
 [ 0.99621307]] 47.55189543025855 [[-8.75979764  4.4714117   4.07266406  2.86661796  8.76132097  8.75691099
   8.75962311 -8.76364187  4.5676139   2.65080995  4.88270573  8.76072923
   3.88670516  0.64625539  2.82493995  2.29224591  1.38885531  1.37571086
   4.59133725  3.4253306   2.73069761  1.509958    1.11547508  0.61502005
  -5.24880042  0.10476934  1.58613081  0.89664135  2.42968118  7.13410901
  -8.67816032 -4.65050153  1.49161397  0.9924062   7.3262583   8.74716069]]
current epoch is  1
Cf in current epoch: 0.25
Spline matrix 12.952805000000012
(23139, 1)
Posterior Probability Estimation Running Time 17.842972400000008
OPT_THR,OPT_SMOOTH 9.094848484848486 42.28906040268456
status: optimal
Running time of updating h, m and spline paras 8.507602899999995
estimated parameters in current epoch 0.1949062620785198 0.005938764070136264 0.09758598775310011 [0.61416454 0.37732295 0.00851251] [[-0.04988654]
 [-0.06554919]
 [ 0.99660154]] 48.048725730302635 [[-9.07166337  3.77694111  3.24477369  1.70786598  9.08611541  9.06669433
   7.60690066 -9.08406801  4.40448167  1.15297377  4.0007457   8.67912313
   4.2574375   1.68758289  2.96952842  1.32448441  0.5557922  -0.33338449
   4.57280139  3.43648159  2.13872047  0.92301139  0.47182252 -0.57825017
  -5.6985472   0.22577405  1.79773643  0.56879942  1.75328141  6.82363261
  -9.05143727 -5.45476475  1.70329212  0.42512172  7.53774683  9.07783474]]
current epoch is  2
Cf in current epoch: 0.25
Spline matrix 12.617507499999988
(23139, 1)
Posterior Probability Estimation Running Time 16.5304845
OPT_THR,OPT_SMOOTH 9.397676767676767 34.23590604026845
status: optimal
Running time of updating h, m and spline paras 8.294603499999994
estimated parameters in current epoch 0.0358121991662854 0.005035609792153377 0.09507215179743146 [0.77882111 0.20852196 0.01265693] [[-0.01298368]
 [-0.0647295 ]
 [ 0.99781838]] 48.64555336759203 [[-8.68896929e+00  1.75006150e+00  2.13801600e+00  2.37656721e-01
   8.95584218e+00  9.20671281e+00  4.90352968e+00 -9.25906955e+00
   3.41916729e+00  2.12526588e-01  2.53186594e+00  7.77483474e+00
   3.54761633e+00  2.01431791e+00  2.23678871e+00  5.56938276e-01
   1.24403243e-01 -1.12156938e+00  3.70178136e+00  2.67726976e+00
   1.64442240e+00  6.39935898e-01 -5.96537548e-03 -9.70298096e-01
  -5.21486206e+00  3.10049400e-01  1.77457030e+00  4.50574968e-01
   1.67591973e+00  6.58259720e+00 -9.26959197e+00 -5.49954027e+00
   1.81086799e+00  2.68947602e-01  7.44647260e+00  9.29263202e+00]]
current epoch is  3
Cf in current epoch: 0.25
Spline matrix 12.607911699999988
(23139, 1)
Posterior Probability Estimation Running Time 16.14099699999997
OPT_THR,OPT_SMOOTH 9.397676767676767 36.24919463087248
status: optimal
Running time of updating h, m and spline paras 8.507189100000005
estimated parameters in current epoch 0.02373925189186756 0.004902704294266163 0.09454121051250322 [0.8140536  0.1721439  0.01380251] [[ 0.00811378]
 [-0.07313426]
 [ 0.9972891 ]] 49.75530216704592 [[-8.89648808 -0.80335136  0.66087277 -1.11208273  6.38055615  9.28607094
   2.15525945 -9.20508582  2.12333375 -1.27382373  0.83918974  4.98558671
   2.72244774  1.28052247  0.98004218 -0.75718027 -1.18722531 -2.41925717
   2.49928083  1.66248896  0.66180384 -0.4153612  -1.27946086 -2.1697049
  -4.92150119 -0.30661782  0.99403106 -0.56767934  0.70489061  5.25577644
  -9.28061747 -5.5020233   1.03445618 -0.62760346  5.90516478  9.29390313]]
current epoch is  4
Cf in current epoch: 0.25
Spline matrix 12.467450100000008
(23139, 1)
Posterior Probability Estimation Running Time 16.20803129999996
OPT_THR,OPT_SMOOTH 9.397676767676767 31.215973154362416
status: optimal
Running time of updating h, m and spline paras 8.215159700000015
estimated parameters in current epoch 0.013658010049425151 0.004874279853943887 0.0944182543608189 [0.83341969 0.1525025  0.01407781] [[ 0.02816552]
 [-0.07040322]
 [ 0.9971209 ]] 50.12958074309831 [[-8.81215313 -2.61669625  0.02672333 -1.66034053  5.32890033  9.15225301
   0.10306848 -8.59258024  1.26523575 -1.78646974  0.36444928  4.14126052
   2.09727805  0.94507836  0.43060062 -1.20471871 -1.65891381 -2.6614932
   2.06656194  1.24379092  0.35697305 -0.6714429  -1.5157742  -2.51603535
  -4.92202243 -0.51397089  0.82128716 -0.70363701  0.57993587  5.35367373
  -9.26025968 -5.5276666   0.89698949 -0.72030733  6.01836574  9.23325231]]
current epoch is  5
Cf in current epoch: 0.25
Spline matrix 12.042740500000036
(23139, 1)
Posterior Probability Estimation Running Time 16.253420500000004
OPT_THR,OPT_SMOOTH 9.397676767676767 28.196040268456375
status: optimal
Running time of updating h, m and spline paras 8.535754999999995
estimated parameters in current epoch 0.012746991192376293 0.004844056467523683 0.0942920919166054 [0.83733839 0.14822362 0.01443799] [[ 0.03801943]
 [-0.06570189]
 [ 0.99711473]] 50.13876610803118 [[-8.77656127 -3.73173292 -0.13129899 -1.74906444  5.34041808  9.10879981
  -1.29905271 -7.657125    0.96443622 -1.8413355   0.37557449  4.14496937
   1.90073845  0.84104995  0.28025672 -1.20390621 -1.6486352  -2.54706696
   1.94951119  1.2001441   0.36607617 -0.58705906 -1.41521067 -2.44790643
  -4.87896038 -0.58524726  0.91973727 -0.59463341  0.84211409  5.88271424
  -9.22711734 -5.57709405  0.99173848 -0.58552596  6.64412884  9.15604941]]
current epoch is  6
Cf in current epoch: 0.25
Spline matrix 12.06486769999998
(23139, 1)
Posterior Probability Estimation Running Time 19.066754799999956
OPT_THR,OPT_SMOOTH 9.397676767676767 28.196040268456375
status: optimal
Running time of updating h, m and spline paras 9.269480299999998
estimated parameters in current epoch 0.01168736822098146 0.004837003263022685 0.09426165135837446 [0.84018301 0.14530254 0.01451446] [[ 0.02727574]
 [-0.0711181 ]
 [ 0.9970949 ]] 50.396665004122326 [[-8.84800038 -4.37568241 -0.18456012 -1.83290223  4.93189218  9.0708773
  -1.99101616 -6.82757957  0.76809352 -1.98330916  0.16631173  3.84743011
   1.81377087  0.76491585  0.08673996 -1.42336757 -1.9762882  -2.74846674
   1.75510624  0.95870792  0.11088559 -0.9486421  -1.8123347  -2.94804531
  -5.27107157 -0.8333992   0.55137167 -0.99554995  0.26573891  5.16286367
  -9.27030584 -5.89022733  0.64647015 -1.03576286  5.99971495  9.23981416]]
current epoch is  7
Cf in current epoch: 0.25
Spline matrix 12.6901072
(23139, 1)
Posterior Probability Estimation Running Time 16.4523054
OPT_THR,OPT_SMOOTH 9.397676767676767 29.20268456375839
status: optimal
Running time of updating h, m and spline paras 8.418804000000023
estimated parameters in current epoch 0.011176553176331608 0.0048336195513638686 0.0942467118939641 [0.84250564 0.14294581 0.01454855] [[ 0.02200116]
 [-0.07733651]
 [ 0.99676227]] 50.45922513972135 [[-8.84655752e+00 -4.77346523e+00 -1.10908006e-01 -1.85172466e+00
   4.70330030e+00  9.03933387e+00 -2.38623160e+00 -5.98661525e+00
   6.95945686e-01 -2.01498770e+00  5.71645463e-03  3.65625044e+00
   1.84851479e+00  8.08009430e-01  5.68822693e-02 -1.49801193e+00
  -2.16192097e+00 -2.97133464e+00  1.83846063e+00  9.67575021e-01
   6.99450638e-02 -1.11545269e+00 -2.02157395e+00 -3.11391325e+00
  -5.26908706e+00 -8.36245170e-01  4.49329524e-01 -1.18100933e+00
   2.90337966e-02  4.65111122e+00 -9.26014142e+00 -5.88605154e+00
   5.27456464e-01 -1.19800490e+00  5.48844574e+00  9.23348207e+00]]
current epoch is  8
Cf in current epoch: 0.25
Spline matrix 12.624297400000046
(23139, 1)
Posterior Probability Estimation Running Time 16.387659400000075
OPT_THR,OPT_SMOOTH 9.397676767676767 29.20268456375839
status: optimal
Running time of updating h, m and spline paras 8.48758620000001
estimated parameters in current epoch 0.010897752534419575 0.004831687665693358 0.09423823968074935 [0.84393829 0.14149345 0.01456826] [[ 0.01867423]
 [-0.08133858]
 [ 0.99651157]] 50.350426898551646 [[-9.06704248 -4.77729864 -0.04147446 -1.61163993  4.6441085   9.16638983
  -2.51880333 -5.24423283  0.84983899 -1.94227168  0.09433001  3.66310357
   2.01115408  0.984264    0.15556328 -1.36764738 -2.15195553 -2.96231125
   2.00967214  1.14583547  0.19218876 -1.07284276 -2.01239806 -3.0663515
  -4.99824447 -0.75646858  0.56961603 -1.17761302  0.06969524  4.48743498
  -9.3386535  -5.6205678   0.52938792 -1.09918285  5.28398726  9.32901312]]
current epoch is  9
Cf in current epoch: 0.25
Spline matrix 12.25974629999996
(23139, 1)
Posterior Probability Estimation Running Time 16.363589599999955
OPT_THR,OPT_SMOOTH 9.397676767676767 28.196040268456375
status: optimal
Running time of updating h, m and spline paras 8.352406499999915
estimated parameters in current epoch 0.010698968408184599 0.0048307596310576744 0.09423412065826363 [0.84458868 0.14083319 0.01457813] [[ 0.01697819]
 [-0.08160904]
 [ 0.9965198 ]] 50.28466444438363 [[-9.12481779 -5.02766789  0.07128095 -1.51928187  4.74240998  9.19315459
  -2.94676688 -4.58159642  0.84834511 -1.8193447   0.13916519  3.78587675
   2.07331598  1.03735478  0.21418931 -1.28065938 -2.08961523 -2.91947138
   2.09320672  1.21957242  0.26364534 -1.02374323 -1.95804929 -2.98751975
  -4.92157069 -0.71153183  0.61717242 -1.13252937  0.12884754  4.53707445
  -9.33435591 -5.55571793  0.56178478 -1.0492574   5.29747768  9.32477092]]
current epoch is  10
Cf in current epoch: 0.25
Spline matrix 12.215533900000082
(23139, 1)
Posterior Probability Estimation Running Time 16.255284200000006
OPT_THR,OPT_SMOOTH 9.397676767676767 28.196040268456375
status: optimal
Running time of updating h, m and spline paras 8.39591669999993
estimated parameters in current epoch 0.010665406475551685 0.004830211737479794 0.09423165396614741 [0.84441444 0.14100141 0.01458415] [[ 0.01556143]
 [-0.08367116]
 [ 0.99637191]] 50.22557825472815 [[-9.16331884 -5.23507445  0.17179536 -1.45201707  4.81777298  9.21371696
  -3.37054188 -3.96519926  0.84687775 -1.73322372  0.14437324  3.8449792
   2.17253699  1.10043987  0.27234509 -1.22419453 -2.0792152  -2.93041899
   2.20075887  1.31785189  0.3345112  -1.00190892 -1.94742577 -2.97619363
  -4.80497122 -0.65441324  0.67121743 -1.11475114  0.15214705  4.60261068
  -9.3294472  -5.49271604  0.59892548 -1.03172086  5.34339319  9.31981664]]
current epoch is  11
Cf in current epoch: 0.25
Spline matrix 12.036275000000046
(23139, 1)
Posterior Probability Estimation Running Time 16.25304600000004
OPT_THR,OPT_SMOOTH 9.397676767676767 29.20268456375839
status: optimal
Running time of updating h, m and spline paras 8.401365100000021
estimated parameters in current epoch 0.011077993148547264 0.004832512999470586 0.09424209077081692 [0.84503885 0.14040189 0.01455926] [[ 0.00965927]
 [-0.08802399]
 [ 0.99607152]] 50.02363808186257 [[-9.23128341 -4.90825082  0.46837019 -1.21378424  4.91333484  9.23780058
  -3.13798117 -3.31977291  1.08729458 -1.47979703  0.27228421  4.075976
   2.53961113  1.37855705  0.51447487 -1.02950822 -1.92764429 -2.81655891
   2.39637859  1.55837373  0.53362368 -0.88295679 -1.87815191 -2.87306045
  -4.50288898 -0.47451726  0.82872336 -1.03599431  0.16689328  4.2907897
  -9.30637767 -5.11299968  0.69014796 -0.90663986  5.08587331  9.30124287]]
current epoch is  12
Cf in current epoch: 0.25
Spline matrix 12.598506499999985
(23139, 1)
Posterior Probability Estimation Running Time 16.35950360000004
OPT_THR,OPT_SMOOTH 9.397676767676767 29.20268456375839
status: optimal
Running time of updating h, m and spline paras 8.21679800000004
estimated parameters in current epoch 0.010560540652781364 0.004831315783523779 0.09423666386146966 [0.84579791 0.13963017 0.01457192] [[ 0.00605956]
 [-0.09015687]
 [ 0.99590914]] 49.874046532157955 [[-9.26516203 -4.71668751  0.6793934  -1.04169252  5.02727453  9.26352404
  -2.99599063 -2.78643657  1.22323117 -1.27429499  0.35461932  4.27230218
   2.73085211  1.57133166  0.68311557 -0.87663384 -1.79922104 -2.74248245
   2.56560397  1.72186387  0.68121348 -0.7808836  -1.80023628 -2.7416675
  -4.3488709  -0.35005132  0.94894328 -0.95764816  0.25180278  4.17553033
  -9.28794694 -4.92119733  0.76758381 -0.79188874  4.97792782  9.28654696]]
current epoch is  13
Cf in current epoch: 0.25
Spline matrix 12.247194100000002
(23139, 1)
Posterior Probability Estimation Running Time 16.546478500000035
OPT_THR,OPT_SMOOTH 9.397676767676767 28.196040268456375
status: optimal
Running time of updating h, m and spline paras 8.113354299999969
estimated parameters in current epoch 0.010760443885366693 0.0048298045387740905 0.09422980204535435 [0.84522091 0.14019049 0.0145886 ] [[ 0.00923618]
 [-0.08950074]
 [ 0.99594393]] 49.91540266225025 [[-9.2447359  -5.12120525  0.6027457  -1.10462624  5.03043752  9.25602022
  -3.65410734 -2.42645516  1.04357182 -1.3073852   0.27386959  4.22817989
   2.63283358  1.46309884  0.6100555  -0.916758   -1.86384917 -2.81165964
   2.5772859   1.70706199  0.66139338 -0.80785367 -1.80335882 -2.74674888
  -4.31339641 -0.35731525  0.93860822 -0.9524305   0.28817215  4.38672351
  -9.2928029  -4.96918725  0.77737252 -0.80395702  5.11699176  9.28547088]]
current epoch is  14
Cf in current epoch: 0.25
Spline matrix 12.373093799999992
(23139, 1)
Posterior Probability Estimation Running Time 16.093597900000077
OPT_THR,OPT_SMOOTH 9.549090909090909 28.196040268456375
status: optimal
Running time of updating h, m and spline paras 8.414076799999975
estimated parameters in current epoch 0.010568243621048001 0.004831339228223086 0.09423678521251741 [0.84572859 0.13969938 0.01457203] [[ 0.00122274]
 [-0.09028258]
 [ 0.99591544]] 49.7820306241234 [[-9.40739711 -4.71908614  0.82293781 -0.85208278  5.17402182  9.40177767
  -3.20859951 -2.1346206   1.27664221 -1.08504701  0.46893022  4.46448635
   2.81990345  1.65593632  0.78750011 -0.74688017 -1.69230518 -2.64244083
   2.64167492  1.81364658  0.75826157 -0.71955823 -1.73476616 -2.64716311
  -4.25077648 -0.34308092  0.99665707 -0.92863772  0.30931006  4.16132495
  -9.39413968 -4.82679999  0.7573502  -0.74070121  4.94403669  9.3986547 ]]
current epoch is  15
Cf in current epoch: 0.25
Spline matrix 12.31170659999998
(23139, 1)
Posterior Probability Estimation Running Time 16.235516500000017
OPT_THR,OPT_SMOOTH 9.397676767676767 30.209328859060403
status: optimal
Running time of updating h, m and spline paras 8.1720732
estimated parameters in current epoch 0.010256518605933502 0.004830013940826272 0.09423076087584441 [0.84575864 0.13965515 0.01458621] [[ 0.00339524]
 [-0.09617567]
 [ 0.99535859]] 49.71713918872595 [[-9.280758   -4.67519022  0.87537801 -0.89482152  5.10914871  9.28162525
  -3.20911306 -1.77577047  1.27736452 -1.08582947  0.32945415  4.40248937
   2.96045529  1.77769396  0.85598082 -0.76103014 -1.77363311 -2.79686329
   2.85430254  1.97119978  0.85669962 -0.72247836 -1.79326744 -2.7035749
  -4.08796375 -0.16678099  1.09943509 -0.90922487  0.28380408  4.10702668
  -9.26574584 -4.6995991   0.87540152 -0.71511192  4.9129072   9.26480654]]
[Open3D WARNING] GLFW Error: WGL: Failed to make context current: The handle is invalid. 
[Open3D WARNING] GLFW Error: WGL: Failed to make context current: The handle is invalid. 
[Open3D WARNING] GLFW Error: WGL: Failed to make context current: The requested transformation operation is not supported. 
[Open3D WARNING] GLFW Error: WGL: Failed to make context current: The handle is invalid. 
[Open3D WARNING] [ViewControl] SetViewPoint() failed because window height and width are not set.
confs_mat: [[1.9779e+04 3.8000e+01 1.1500e+02]
 [2.4600e+02 2.7370e+03 2.0000e+01]
 [0.0000e+00 1.0000e+00 2.0300e+02]]
FPR,FNR 0.0019368295589988081 0.08857808857808858